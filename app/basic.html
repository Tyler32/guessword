<!doctype html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>

    <!-- Disable tap highlight on IE -->
    <meta name="msapplication-tap-highlight" content="no">

    <!-- Web Application Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Web Starter Kit">
    <link rel="icon" sizes="192x192" href="images/touch/chrome-touch-icon-192x192.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Web Starter Kit">
    <link rel="apple-touch-icon" href="images/touch/apple-touch-icon.png">

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">
    <meta name="msapplication-TileColor" content="#2F3BA2">

    <!-- Color the status bar on mobile devices -->
    <meta name="theme-color" content="#2F3BA2">

      <link rel="stylesheet" href="/guessword/app/styles/main.css">

      <style>

          #top,
          #middle,
          #bottom {
              position: fixed;
              left: 0;
              right: 0;
              height: 33%;
          }

          #top {
              top: 0;
              background-color: orange;
          }

          #middle {
              top: 33%;
              background-color: brown;
          }

          #bottom {
              bottom: 0;
              background-color: green;
          }

          .toprightcorner{
              position:fixed;
              top:10px;
              right:10px;
          }

          .team-1-text{
          }

          .team-1-Btn{
          }

          .guesswordtext {
              text-align:center;
          }

          .startGameBtn {
              text-align:center;
          }



      </style>

    <!-- SEO: If your mobile URL is different from the desktop URL, add a canonical link to the desktop page https://developers.google.com/webmasters/smartphone-sites/feature-phones -->
    <!--
    <link rel="canonical" href="http://www.example.com/">
    -->
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>

  </head>
  <body>

    <div id="top">
        <p class="team-1-text" id="team1Score">Team 1: 0</p>

        <div class="team-1-Btn">
            <input type='button' value='Add' id='team1Btn'>
        </div>

        <p class="toprightcorner" id="team2Score">Team 2: 0</p>

        <div style="float: right;">
            <input type='button' value='Add' id='team2Btn'>
        </div>
    </div>

    <div id="middle">
        <p class="guesswordtext" id="wordToGuessText">GuessWord</p>

        <div class="startGameBtn">
            <input type='button' value='Start' id='theBtnToRuleThemAll'>
        </div>
    </div>

    <div id="bottom">
    </div>

    <script>
        var guessWords = [];
        var team1Score = 0;
        var team2Score = 0;

        var beepIntervalId;
        var roundIntervalId;
        var midRoundIntervalId;
        var tenseIntervalId;
        var roundTime = 4500;

        var guessWordsIndex = 0;

        var beepAudio = new Audio("sounds/beep.mp3");
        var endRoundAudio = new Audio("sounds/end.mp3");
        var endGameAudio = new Audio("sounds/endgame.wav");

        //loadWords(['/categories/lotr.txt', '/categories/DigiPen.txt']);
        //loadWords(['http://localhost:63342/guessword/app/categories/lotr.txt', 'http://localhost:63342/guessword/app/categories/HarryPotter.txt']);
        loadWords(['http://localhost:63342/guessword/app/categories/lotr.txt', 'http://localhost:63342/guessword/app/categories/DigiPen.txt']);

        function loadWords($files) {

            $.each($files, function( index, value ) {
                console.log(value);
                $.ajax({
                    url : value,
                    type : "get",
                    async: false,
                    success : function(data) {
                        var words = data.split('\n');
                        guessWords = $.merge(words, guessWords);
                        console.log(guessWords);
                    }
                });
            });

            guessWords = shuffle(guessWords);
            console.log(guessWords);
            guessWordsIndex = 0;
        };

        $("#theBtnToRuleThemAll").click(function(){
            console.log($('#theBtnToRuleThemAll').val())
            var btnText = $('#theBtnToRuleThemAll').val();

            if(btnText == 'Next') {
                $('#wordToGuessText').prop('innerHTML', guessWords[guessWordsIndex++ % guessWords.length]);
            }
            else {
                //Round length 45-55 seconds
                roundTime = 45000 + Math.random() * 10000;
                beepIntervalId = setInterval(function() { beepAudio.play(); }, 1400);
                midRoundIntervalId = setInterval(function() {
                    clearInterval(midRoundIntervalId);
                    clearInterval(beepIntervalId);
                    beepAudio.play();
                    beepIntervalId = setInterval(function() { beepAudio.play(); }, 700);
                }, roundTime *.60);

                tenseIntervalId = setInterval(function() {
                    clearInterval(tenseIntervalId);
                    clearInterval(beepIntervalId);
                    beepAudio.play();
                    beepIntervalId = setInterval(function() { beepAudio.play(); }, 500);
                }, roundTime *.82);

                roundIntervalId = setInterval(endRound, roundTime);

                $('#theBtnToRuleThemAll').val('Next');
                $('#wordToGuessText').prop('innerHTML', guessWords[guessWordsIndex++ % guessWords.length]);
            }

        });

        $("#team1Btn").click(function(){
            console.log("team1BtnClick")
            var btnText = $('#theBtnToRuleThemAll').val();

            if(btnText == 'Next Round') {
                $('#team1Score').prop('innerHTML', "Team 1: " + ++team1Score);
                checkScores();
            }
        });

        $("#team2Btn").click(function(){
            console.log("team2BtnClick")
            var btnText = $('#theBtnToRuleThemAll').val();

            if(btnText == 'Next Round') {
                $('#team2Score').prop('innerHTML', "Team 2: " + ++team2Score);
                checkScores();
            }
        });

        function endRound() {
            endRoundAudio.play();
            clearInterval(roundIntervalId);
            clearInterval(beepIntervalId);

            $('#theBtnToRuleThemAll').val('Next Round');
        }

        function checkScores() {
            var gameOver = false;
            if(team1Score >= 7) {
                gameOver = true;
                $('#wordToGuessText').prop('innerHTML', "Team 1 Wins!");

            }
            else if(team2Score >= 7) {
                gameOver = true;
                $('#wordToGuessText').prop('innerHTML', "Team 2 Wins!");
            }

            if(gameOver == true) {
               endGameAudio.play();
                $('#theBtnToRuleThemAll').val('Start');
                team1Score = 0;
                team2Score = 0;
            }
        }

        function shuffle(array) {
            var currentIndex = array.length, temporaryValue, randomIndex;

            // While there remain elements to shuffle...
            while (0 !== currentIndex) {

                // Pick a remaining element...
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex -= 1;

                // And swap it with the current element.
                temporaryValue = array[currentIndex];
                array[currentIndex] = array[randomIndex];
                array[randomIndex] = temporaryValue;
            }

            return array;
        }

    </script>

    <!-- Google Analytics: change UA-XXXXX-X to be your site's ID -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-XXXXX-X', 'auto');
      ga('send', 'pageview');
    </script>
    <!-- Built with love using Web Starter Kit -->
  </body>
</html>
